## This program is protected under the GNU GPL (See COPYING)

CC = @CC@
MAKE = @MAKE@

prefix = @prefix@
exec_prefix = @exec_prefix@
bindir = ${DESTDIR}@bindir@
CFLAGS += -O2 -Wall -Wextra
LIBS = @LIBS@
DEFAULT_FILE_DIR = $(HOME)

ifeq (@menu@, 1)
  OFILES = highlight.o io.o main.o menu.o misc.o tables.o utils.o
else
  OFILES = highlight.o io.o main.o misc.o tables.o utils.o
endif

default: all

all:	ct

ct: Makefile $(OFILES) defs.h
	$(CC) $(CFLAGS) -o $@ $(OFILES) $(LIBS)
	rm -f $(OFILES)

keepcompiled: Makefile $(OFILES) defs.h
	$(CC) $(CFLAGS) -o $@ $(OFILES) $(LIBS)

Makefile: Makefile.in
	@echo "You need to run ./configure first; then try make."
	@exit 1

install: ct
	-mkdir -p $(bindir)
	cp ct $(bindir)

uninstall:
	rm -f $(bindir)/ct

# Autocompile all .c files into .o files using this rule:
.c.o:
	$(CC) $(CFLAGS) -c $<

clean:
	rm -f $(OFILES) config.status config.log

test:
	../.test.sh | ./ct -c ../.test_chromatermrc

	cat ./some_file
	rm -f ./some_file

distclean:
	rm -f *.o config.status config.log ct Makefile config.h
